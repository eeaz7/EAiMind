<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Flight Adventure</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes dragonFlap {
            0% { transform: translateY(0) scaleX(1); }
            50% { transform: translateY(-5px) scaleX(1); }
            100% { transform: translateY(0) scaleX(1); }
        }
        
        .dragon {
            animation: dragonFlap 0.5s infinite;
        }
        
        .dragon-left {
            transform: scaleX(-1);
        }
        
        .game-over {
            transform: rotate(90deg);
            transition: transform 0.5s;
        }
        
        .obstacle {
            position: absolute;
        }
        
        #gameContainer {
            position: relative;
            overflow: hidden;
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA);
        }
        
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
        }
        
        .fire {
            position: absolute;
            width: 20px;
            height: 10px;
            background: orange;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 0 0 10px yellow;
        }
    </style>
</head>
<body class="bg-blue-100 flex flex-col items-center justify-center min-h-screen">
    <div class="text-center mb-4">
        <h1 class="text-4xl font-bold text-purple-800 mb-2">Dragon Flight Adventure</h1>
        <p class="text-gray-700">Control your dragon through obstacles!</p>
    </div>
    
    <div id="gameContainer" class="w-full max-w-md h-96 border-4 border-blue-500 rounded-lg relative">
        <div id="dragon" class="dragon absolute left-1/2 w-16 h-16 bg-red-500 rounded-full flex items-center justify-center">
            <div class="w-8 h-8 bg-yellow-300 rounded-full absolute -left-2"></div>
            <div class="w-4 h-4 bg-white rounded-full absolute right-4"></div>
            <div class="w-2 h-2 bg-black rounded-full absolute right-5 top-3"></div>
            <div class="w-12 h-4 bg-red-600 rounded-full absolute -bottom-2"></div>
            <div class="w-4 h-8 bg-red-600 rounded-full absolute -right-2 top-4"></div>
            <div id="fire" class="fire -left-4 top-6 hidden"></div>
        </div>
        
        <div id="scoreDisplay" class="absolute top-2 left-2 bg-white bg-opacity-70 px-2 py-1 rounded font-bold">Score: 0</div>
        <div id="healthDisplay" class="absolute top-2 right-2 bg-white bg-opacity-70 px-2 py-1 rounded font-bold">❤️❤️❤️</div>
    </div>
    
    <div class="mt-6 flex flex-col items-center">
        <button id="startBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full mb-2">
            Start Game
        </button>
        <div class="flex gap-4 mt-2">
            <button id="leftBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                ← Left
            </button>
            <button id="upBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                ↑ Up
            </button>
            <button id="rightBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                → Right
            </button>
            <button id="fireBtn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded">
                Fire!
            </button>
        </div>
        <p class="text-gray-600 mt-4">Controls: Arrow keys or buttons above<br>Space to fly up, Shift to breathe fire</p>
    </div>
    
    <div id="gameOverModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg max-w-sm w-full text-center">
            <h2 class="text-2xl font-bold text-red-600 mb-2">Game Over!</h2>
            <p id="finalScore" class="text-xl mb-4">Your score: 0</p>
            <button id="restartBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full">
                Play Again
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const dragon = document.getElementById('dragon');
            const fire = document.getElementById('fire');
            const gameContainer = document.getElementById('gameContainer');
            const startBtn = document.getElementById('startBtn');
            const restartBtn = document.getElementById('restartBtn');
            const leftBtn = document.getElementById('leftBtn');
            const upBtn = document.getElementById('upBtn');
            const rightBtn = document.getElementById('rightBtn');
            const fireBtn = document.getElementById('fireBtn');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const healthDisplay = document.getElementById('healthDisplay');
            const gameOverModal = document.getElementById('gameOverModal');
            const finalScore = document.getElementById('finalScore');
            
            let gameRunning = false;
            let score = 0;
            let health = 3;
            let gravity = 0.5;
            let dragonY = 150;
            let dragonX = 150;
            let dragonVelocityY = 0;
            let dragonVelocityX = 0;
            let dragonDirection = 1; // 1 for right, -1 for left
            let obstacleInterval;
            let obstacles = [];
            let clouds = [];
            let fires = [];
            let cloudInterval;
            let isFiring = false;
            
            // Game functions
            function startGame() {
                gameRunning = true;
                score = 0;
                health = 3;
                dragonY = 150;
                dragonX = 150;
                dragonVelocityY = 0;
                dragonVelocityX = 0;
                dragonDirection = 1;
                scoreDisplay.textContent = `Score: ${score}`;
                healthDisplay.textContent = '❤️'.repeat(health);
                dragon.style.top = `${dragonY}px`;
                dragon.style.left = `${dragonX}px`;
                dragon.classList.remove('game-over');
                dragon.classList.remove('dragon-left');
                
                // Clear existing elements
                obstacles.forEach(obstacle => obstacle.element.remove());
                obstacles = [];
                clouds.forEach(cloud => cloud.remove());
                clouds = [];
                fires.forEach(f => f.remove());
                fires = [];
                
                // Start intervals
                obstacleInterval = setInterval(createObstacle, 1500);
                cloudInterval = setInterval(createCloud, 2000);
                
                // Start game loop
                requestAnimationFrame(gameLoop);
                
                startBtn.disabled = true;
            }
            
            function endGame() {
                gameRunning = false;
                clearInterval(obstacleInterval);
                clearInterval(cloudInterval);
                dragon.classList.add('game-over');
                finalScore.textContent = `Your score: ${score}`;
                gameOverModal.classList.remove('hidden');
                startBtn.disabled = false;
            }
            
            function gameLoop() {
                if (!gameRunning) return;
                
                // Apply gravity
                dragonVelocityY += gravity;
                dragonY += dragonVelocityY;
                dragonX += dragonVelocityX;
                
                // Keep dragon within bounds
                if (dragonY < 0) {
                    dragonY = 0;
                    dragonVelocityY = 0;
                }
                
                if (dragonY > gameContainer.clientHeight - 64) {
                    dragonY = gameContainer.clientHeight - 64;
                    takeDamage();
                }
                
                if (dragonX < 0) {
                    dragonX = 0;
                    dragonVelocityX = 0;
                }
                
                if (dragonX > gameContainer.clientWidth - 64) {
                    dragonX = gameContainer.clientWidth - 64;
                    dragonVelocityX = 0;
                }
                
                dragon.style.top = `${dragonY}px`;
                dragon.style.left = `${dragonX}px`;
                
                // Update dragon direction
                if (dragonVelocityX > 0) {
                    dragonDirection = 1;
                    dragon.classList.remove('dragon-left');
                } else if (dragonVelocityX < 0) {
                    dragonDirection = -1;
                    dragon.classList.add('dragon-left');
                }
                
                // Move obstacles and check collisions
                obstacles.forEach((obstacle, index) => {
                    const obstacleElement = obstacle.element;
                    const obstacleX = parseFloat(obstacleElement.style.left || obstacleElement.style.right);
                    
                    if (obstacle.type === 'vertical') {
                        // Vertical obstacles (moving left/right)
                        obstacleElement.style.left = `${obstacleX + obstacle.speed}px`;
                        
                        // Check if obstacle passed the dragon
                        if ((obstacle.speed > 0 && obstacleX > gameContainer.clientWidth) || 
                            (obstacle.speed < 0 && obstacleX < -50)) {
                            if (!obstacle.passed) {
                                obstacle.passed = true;
                                score++;
                                scoreDisplay.textContent = `Score: ${score}`;
                            }
                        }
                        
                        // Check collision
                        if (checkCollision(dragonX, dragonY, 64, 64, 
                                          obstacleX, obstacle.y, obstacle.width, obstacle.height)) {
                            takeDamage();
                        }
                        
                        // Remove obstacle if off screen
                        if ((obstacle.speed > 0 && obstacleX > gameContainer.clientWidth + 50) || 
                            (obstacle.speed < 0 && obstacleX < -50)) {
                            obstacleElement.remove();
                            obstacles.splice(index, 1);
                        }
                    } else {
                        // Horizontal obstacles (moving up/down)
                        const obstacleY = parseFloat(obstacleElement.style.top || obstacleElement.style.bottom);
                        obstacleElement.style.top = `${obstacleY + obstacle.speed}px`;
                        
                        // Check collision
                        if (checkCollision(dragonX, dragonY, 64, 64, 
                                          obstacle.x, obstacleY, obstacle.width, obstacle.height)) {
                            takeDamage();
                        }
                        
                        // Remove obstacle if off screen
                        if ((obstacle.speed > 0 && obstacleY > gameContainer.clientHeight) || 
                            (obstacle.speed < 0 && obstacleY < -50)) {
                            obstacleElement.remove();
                            obstacles.splice(index, 1);
                        }
                    }
                });
                
                // Move clouds
                clouds.forEach((cloud, index) => {
                    const cloudX = parseFloat(cloud.style.left);
                    cloud.style.left = `${cloudX - 1}px`;
                    
                    if (cloudX < -100) {
                        cloud.remove();
                        clouds.splice(index, 1);
                    }
                });
                
                // Move fireballs
                fires.forEach((fireball, index) => {
                    const fireX = parseFloat(fireball.style.left);
                    const newX = fireX + (10 * dragonDirection);
                    fireball.style.left = `${newX}px`;
                    
                    // Check if fireball hit any obstacles
                    obstacles.forEach((obstacle, obsIndex) => {
                        if (checkCollision(newX, parseFloat(fireball.style.top), 20, 10, 
                                          parseFloat(obstacle.element.style.left || obstacle.element.style.right), 
                                          parseFloat(obstacle.element.style.top || obstacle.element.style.bottom), 
                                          obstacle.width, obstacle.height)) {
                            // Remove both fireball and obstacle
                            fireball.remove();
                            fires.splice(index, 1);
                            obstacle.element.remove();
                            obstacles.splice(obsIndex, 1);
                            score += 2;
                            scoreDisplay.textContent = `Score: ${score}`;
                        }
                    });
                    
                    // Remove if off screen
                    if (newX < -20 || newX > gameContainer.clientWidth + 20) {
                        fireball.remove();
                        fires.splice(index, 1);
                    }
                });
                
                requestAnimationFrame(gameLoop);
            }
            
            function checkCollision(x1, y1, w1, h1, x2, y2, w2, h2) {
                return x1 < x2 + w2 &&
                       x1 + w1 > x2 &&
                       y1 < y2 + h2 &&
                       y1 + h1 > y2;
            }
            
            function takeDamage() {
                health--;
                healthDisplay.textContent = '❤️'.repeat(health);
                
                // Flash dragon red when hit
                dragon.classList.add('bg-red-700');
                setTimeout(() => dragon.classList.remove('bg-red-700'), 200);
                
                if (health <= 0) {
                    endGame();
                }
            }
            
            function createObstacle() {
                if (!gameRunning) return;
                
                const obstacleTypes = ['vertical', 'horizontal'];
                const type = obstacleTypes[Math.floor(Math.random() * obstacleTypes.length)];
                
                if (type === 'vertical') {
                    // Vertical obstacle (moves left or right)
                    const obstacle = document.createElement('div');
                    const width = Math.floor(Math.random() * 30) + 20;
                    const height = Math.floor(Math.random() * 100) + 50;
                    const y = Math.floor(Math.random() * (gameContainer.clientHeight - height));
                    const speed = Math.random() > 0.5 ? 3 : -3;
                    
                    obstacle.className = 'obstacle bg-purple-600 rounded';
                    obstacle.style.width = `${width}px`;
                    obstacle.style.height = `${height}px`;
                    
                    if (speed > 0) {
                        obstacle.style.left = '0';
                    } else {
                        obstacle.style.right = '0';
                    }
                    
                    obstacle.style.top = `${y}px`;
                    
                    gameContainer.appendChild(obstacle);
                    
                    obstacles.push({
                        element: obstacle,
                        type: 'vertical',
                        y: y,
                        width: width,
                        height: height,
                        speed: speed,
                        passed: false
                    });
                } else {
                    // Horizontal obstacle (moves up or down)
                    const obstacle = document.createElement('div');
                    const width = Math.floor(Math.random() * 150) + 50;
                    const height = Math.floor(Math.random() * 30) + 20;
                    const x = Math.floor(Math.random() * (gameContainer.clientWidth - width));
                    const speed = Math.random() > 0.5 ? 2 : -2;
                    
                    obstacle.className = 'obstacle bg-green-600 rounded';
                    obstacle.style.width = `${width}px`;
                    obstacle.style.height = `${height}px`;
                    obstacle.style.left = `${x}px`;
                    
                    if (speed > 0) {
                        obstacle.style.top = '0';
                    } else {
                        obstacle.style.bottom = '0';
                    }
                    
                    gameContainer.appendChild(obstacle);
                    
                    obstacles.push({
                        element: obstacle,
                        type: 'horizontal',
                        x: x,
                        width: width,
                        height: height,
                        speed: speed,
                        passed: false
                    });
                }
            }
            
            function createCloud() {
                if (!gameRunning) return;
                
                const cloud = document.createElement('div');
                const size = Math.floor(Math.random() * 50) + 30;
                const y = Math.floor(Math.random() * (gameContainer.clientHeight - size));
                
                cloud.className = 'cloud';
                cloud.style.width = `${size}px`;
                cloud.style.height = `${size}px`;
                cloud.style.left = `${gameContainer.clientWidth}px`;
                cloud.style.top = `${y}px`;
                
                // Add some cloud details
                for (let i = 0; i < 3; i++) {
                    const cloudPart = document.createElement('div');
                    const partSize = size * (0.6 + Math.random() * 0.4);
                    cloudPart.className = 'cloud';
                    cloudPart.style.width = `${partSize}px`;
                    cloudPart.style.height = `${partSize}px`;
                    cloudPart.style.top = `${Math.random() * 20 - 10}px`;
                    cloudPart.style.left = `${Math.random() * 20 - 10}px`;
                    cloud.appendChild(cloudPart);
                }
                
                gameContainer.appendChild(cloud);
                clouds.push(cloud);
            }
            
            function jump() {
                if (!gameRunning) return;
                dragonVelocityY = -10;
            }
            
            function moveLeft() {
                if (!gameRunning) return;
                dragonVelocityX = -5;
            }
            
            function moveRight() {
                if (!gameRunning) return;
                dragonVelocityX = 5;
            }
            
            function stopHorizontal() {
                dragonVelocityX = 0;
            }
            
            function breatheFire() {
                if (!gameRunning || isFiring) return;
                
                isFiring = true;
                fire.classList.remove('hidden');
                
                // Create fireball
                const fireball = document.createElement('div');
                fireball.className = 'fire';
                fireball.style.left = `${dragonDirection === 1 ? dragonX + 64 : dragonX - 20}px`;
                fireball.style.top = `${dragonY + 24}px`;
                gameContainer.appendChild(fireball);
                fires.push(fireball);
                
                setTimeout(() => {
                    fire.classList.add('hidden');
                    isFiring = false;
                }, 300);
            }
            
            // Event listeners
            startBtn.addEventListener('click', startGame);
            restartBtn.addEventListener('click', () => {
                gameOverModal.classList.add('hidden');
                startGame();
            });
            
            // Button controls
            leftBtn.addEventListener('mousedown', moveLeft);
            leftBtn.addEventListener('mouseup', stopHorizontal);
            leftBtn.addEventListener('mouseleave', stopHorizontal);
            
            upBtn.addEventListener('click', jump);
            
            rightBtn.addEventListener('mousedown', moveRight);
            rightBtn.addEventListener('mouseup', stopHorizontal);
            rightBtn.addEventListener('mouseleave', stopHorizontal);
            
            fireBtn.addEventListener('click', breatheFire);
            
            // Keyboard controls
            document.addEventListener('keydown', (e) => {
                if (!gameRunning) return;
                
                switch(e.key) {
                    case ' ':
                        e.preventDefault();
                        jump();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        moveLeft();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        moveRight();
                        break;
                    case 'Shift':
                        e.preventDefault();
                        breatheFire();
                        break;
                }
            });
            
            document.addEventListener('keyup', (e) => {
                if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                    stopHorizontal();
                }
            });
            
            // Touch controls for mobile
            gameContainer.addEventListener('touchstart', (e) => {
                if (!gameRunning) return;
                
                const touchX = e.touches[0].clientX - gameContainer.getBoundingClientRect().left;
                const containerWidth = gameContainer.clientWidth;
                
                if (touchX < containerWidth / 3) {
                    moveLeft();
                } else if (touchX > containerWidth * 2/3) {
                    moveRight();
                } else {
                    jump();
                }
            });
            
            gameContainer.addEventListener('touchend', stopHorizontal);
        });
    </script>
</body>
</html>
